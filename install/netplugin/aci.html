<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Setting up ACI.">

    <link rel="shortcut icon" href="/assets/images/favicon.png">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <title>ACI setup - Contiv</title>

    <link href="/assets/stylesheets/application-6854335d.css" rel="stylesheet"/>

    <!--[if lt IE 9]><script src="/assets/javascripts/html5shiv-099439cc.js"></script><script src="/assets/javascripts/respond.min-1eb35b04.js"></script><![endif]-->

    
  </head>

  <body id="page-ACI setup" class=" page-ACI setup layout-install page-sub">

<div id="header" class="navbar-static-top">
  <div class="container">
    <div class="row">
      
        <div class="navbar-header">
          <div class="navbar-brand">
              <a class="logo" href="/">Contiv</a>
            </a>
          </div>
          
        </div>
        <div class="buttons hidden-xs">
          <nav role="navigation">
            <ul class="main-links nav navbar-nav navbar-left">
              <li class="first li-under"><a href="/install/index.html">Documentation</a></li>
              <li class="li-under"><a href="/articles/index.html">Articles</a></li>
              <li class="li-under"><a href="https://github.com/contiv" target="_blank">
                        GitHub
                        <i class="fa fa-github fa-lg"></i>
                        </a></li>
                    <li class="li-under"><a href="https://contiv.slack.com" target="_blank">
                        Slack
                        <i class="fa fa-slack fa-lg"></i>
                        </a></li>
                    <li><a href="https://twitter.com/projectcontiv" target="_blank">
                        Twitter
                        <i class="fa fa-twitter fa-lg"></i>
                        </a></li>
            </ul>
          </nav>
        </div>
      
    </div>
  </div>
</div>


<div class="sidebar-overlay"></div>


<aside id="sidebar" class="sidebar sidebar-default sidebar-fixed-right" role="navigation">
    
    <div class="sidebar-header header-cover">
        
        <div class="sidebar-image">
            <img src="/assets/images/logo-header@2x.png" width="49px" height="56px">
        </div>
    </div>

    
    <ul class="main nav sidebar-nav">
        <li class="first"><a href="/intro/index.html">Intro</a></li>
        <li class=""><a href="/docs/index.html">Docs</a></li>
    </ul>
    <div class="divider"></div>
    
    <ul class="external nav sidebar-nav">
        <li class=""><a class="v-btn gray sml" href="https://github.com/contiv"><svg id="svg-download" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" style="enable-background:new 0 0 14 14;">
  <style>
  </style>
  <path class="" d="M13,0H1C0.5,0,0,0.5,0,1v12c0,0.5,0.5,1,1,1h4.7c0,0,0,0,0-0.1c0-0.2,0-0.6,0-1.1c-1.8,0.4-2.2-0.9-2.2-0.9
    c-0.3-0.8-0.7-1-0.7-1c-0.6-0.4,0-0.4,0-0.4c0.7,0,1,0.7,1,0.7c0.6,1,1.5,0.7,1.9,0.5c0.1-0.4,0.2-0.7,0.4-0.9c-1.5-0.2-3-0.7-3-3.2
    c0-0.7,0.3-1.3,0.7-1.8C3.7,5.8,3.5,5.1,3.9,4.2c0,0,0.6-0.2,1.8,0.7c0.5-0.1,1.1-0.2,1.6-0.2c0.6,0,1.1,0.1,1.6,0.2
    c1.3-0.8,1.8-0.7,1.8-0.7c0.4,0.9,0.1,1.6,0.1,1.7c0.4,0.5,0.7,1,0.7,1.8c0,2.5-1.5,3.1-3,3.2C8.7,11.1,9,11.5,9,12.1
    c0,0.9,0,1.6,0,1.8c0,0,0,0,0,0.1h4c0.5,0,1-0.5,1-1V1C14,0.5,13.5,0,13,0z"/>
</svg>
GitHub</a></li>
    </ul>
</aside>


<div class="container">
	<div class="row">
		<div class="col-md-3 col-sm-3 col-xs-12">
					<div class="docs-sidebar hidden-print affix-top" role="complementary">
			<hr>
			<h3>User Guide</h3>
			<ul class="nav docs-sidenav">
				<li class="active">
					<a data-toggle="collapse" href="#collapse100" href="/install/user_guides/getting_started/index.html">Getting Started</a>
				<div id="collapse100" class="panel-collapse collapse">

					<ul class="nav nav-visible">
						<li>
							<a href="/install/user_guides/getting_started/community_talks/index.html">Talks and Demonstrations</a>
						</li>
						<li>
							<a data-toggle="collapse" href="#collapse110" href="/install/user_guides/getting_started/networking/index.html">Networking</a>
									<div id="collapse110" class="panel-collapse collapse">
										<ul class="nav nav-visible">
											<li>
													<a href="/install/user_guides/getting_started/networking/vagrant.html"> Development Setup with Vagrant</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/mcast.html">Multicast Demonstration</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/basic_server_setup.html">Basic Server Setup</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/swarm.html">Docker Swarm</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/k8s.html">Kubernetes</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/mesos.html">Mesos</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/nomad.html">Nomad</a>
											</li>
											<li>
													<a href="/install/user_guides/getting_started/networking/bgp.html">BGP</a>
											</li>
										</ul>
									</div>

						</li>
						<li>
							<a data-toggle="collapse" href="#collapse120" href="/install/user_guides/getting_started/network_topologies/index.html">Network Topologies</a>
							<div id="collapse120" class="panel-collapse collapse">
								<ul class="nav nav-visible">
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/native_routed.html">Native Routing</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/native_bridged.html">Native Bridging</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/openstack.html">Openstack Deployment</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/cloud.html">Cloud Deployment</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/vagrant.html">Vagrant Setup</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/networking101.html">Containers Networking Tutorial</a>
									</li>
									<li>
										<a href="/install/user_guides/getting_started/network_topologies/bgp.html">BGP</a>
									</li>
								</ul>
							</div>
						</li>
						<li>
							<a data-toggle="collapse" href="#collapse130" href="/install/user_guides/getting_started/storage/index.html">Storage </a>
							<div id="collapse130" class="panel-collapse collapse">
								<ul class="nav">
									<li><a href="/install/user_guides/getting_started/storage/swarm.html">Docker Swarm</a></li>
								</ul>
							</div>
						</li>
						<li>
							<a data-toggle="collapse" href="#collapse140" href="/install/user_guides/getting_started/storage_systems/index.html">Storage Systems</a>
							<div id="collapse140" class="panel-collapse collapse">
								<ul class="nav">
									<li><a href="/install/user_guides/getting_started/storage_systems/ceph.html">Ceph</a></li>
									<li><a href="/install/user_guides/getting_started/storage_systems/nfs.html">NFS</a></li>
								</ul>
							</div>
						</li>
					</ul>
				</div>
				</li>
				<li><a data-toggle="collapse" href="#collapse200" href="/install/user_guides/networking/index.html">Networking</a>
					<div id="collapse200" class="panel-collapse collapse">
						<ul class="nav nav-visible">
							<li><a href="/install/user_guides/networking/concepts.html">Terminology</a></li>
							<li><a href="/install/user_guides/networking/networks.html">Networks</a></li>
							<li><a href="/install/user_guides/networking/tenants.html">Tenants</a></li>
							<li><a href="/install/user_guides/networking/policies.html">Policies</a></li>
							<li><a href="/install/user_guides/networking/external_connectivity.html">External Connectivity</a></li>
							<li><a href="/install/user_guides/networking/service_discovery.html">Service Discovery</a></li>
							<li><a href="/install/user_guides/networking/ipam.html">IP Address Management</a></li>
							<li> <a href="/install/user_guides/networking/hybrid_workloads.html">Hybrid Workloads</a></li>
						</ul>
					</div>
				</li>
				<li><a data-toggle="collapse" href="#collapse300" href="/install/user_guides/storage/index.html">Storage</a>
					<div id="collapse300" class="panel-collapse collapse">
						<ul class="nav nav-visible">
							<li><a href="/install/user_guides/storage/concepts.html">Terminology</a></li>
							<li><a data-toggle="collapse" href="#collapse320" href="/install/user_guides/storage/policies/index.html">Policies</a></li>
								<div id="collapse320" class="panel-collapse collapse">
									<ul class="nav nav-visible">
										<li>
											<a href="/install/user_guides/storage/policies/allocation.html">Allocation</a></li>
										<li>
											<a href="/install/user_guides/storage/policies/rate_limiting.html">IOPs Rate Limiting</a></li>
										<li>
											<a href="/install/user_guides/storage/policies/snapshots.html">Snapshots</a></li>
										<li>
											<a href="/install/user_guides/storage/policies/filesystem.html">FileSystem</a></li>
									</ul>
								</div>
							<li><a href="/install/user_guides/storage/ceph.html">Ceph</a></li>
							<li><a href="/install/user_guides/storage/nfs.html">NFS</a></li>
							<li><a href="/install/user_guides/storage/disk_management.html">Disk Management</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a data-toggle="collapse" href="#collapse400" href="/install/user_guides/cluster/index.html">Cluster</a>
					<div id="collapse400" class="panel-collapse collapse">
						<ul class="nav nav-visible">
								<li><a href="/install/user_guides/cluster/concepts.html">Terminology</a></li>
								<li><a href="/install/user_guides/cluster/discovery.html">Discovery</a></li>
								<li><a href="/install/user_guides/cluster/commissioning.html">Commissioning and Decommissioning</a></li>
						</ul>
					</div>
				</li>
				<hr><p>
				<h3>Reference</h3>
					<ul class="nav nav-visible">
						<li><a href="https://godoc.org/github.com/contiv/netplugin">Network API Reference</a><br></li>
						<li><a href="https://godoc.org/github.com/contiv/contivmodel/client">Storage API Reference</a><br></li>
						<li><a href="https://godoc.org/github.com/contiv/cluster">Cluster API Reference</a><br></li>
					</ul>
				<hr><p>
				<h3>Examples</h3>
					<ul class="nav nav-visible">
						<li><a href="/install/samples/index.html">Example Use Cases</a><br></li>
					</ul>
				<hr><p>

				</li>
			</ul>
		</div>

		</div>  
		<div id="main-content" class="col-sm-9 col-md-9 col-xs-12" role="main">
			<div class="bs-docs-section">
				
	<h2>Setting Up Contiv Networking in ACI</h2>
<p>This document describes how to set up a Contiv Network cluster in ACI mode. The steps listed here are in addition to the steps presented in the <a href="https://github.com/contiv/demo/tree/master/net/README.md">general README</a>.</p>

<h3>Prerequisites for ACI Setup</h3>

<h4>VLANS</h4>
<p>Contiv currently uses vlans starting from 100. Therefore, a block of vlans starting from 100 must be
 reserved for use by Contiv. (The vlan range will be made configurable in a subsequent release.)</p>

<h3>APIC Configuration: Fabric and Access Policies</h3>
<pre class="highlight plaintext"><code>1. Create a physical domain named "allvlans" (For now, this name is hard-coded. The name will be made configurable in a follow-on release).

2. Create a vlan pool with a block of vlans starting with 100 as described above. Set allocation mode to "Static Allocation" and associate the pool with the "allvlans" physical domain.

3. Create an Attachable Access Entity Profile (AAEP) and associate it with the "allvlans" physical domain.

4. Create a Policy Group (under Interface Policies) and specify the AAEP created in the previous step.

5. Create an Interface Profile and specify the physical interfaces connected from your ToR(s) to the bare metal servers. You can create separate Interface Profiles for individual ToRs if you like.

6. Create a Switch Profile (Switch Policies/Profiles) and specify the appropriate interface profile created in step 4.

7. Make a note of the full node name(s) of the ToR(s) you have connected to your servers.

8. Find the interface name of the NIC on the server that is connected to the ToR (e.g. eth5).
</code></pre>

<h3>Additional Configuration Information</h3>
<p>A sample <strong>cfg.yml</strong> for ACI setup is at: <a href="https://github.com/contiv/demo/tree/master/net/extras/sample_aci_cfg.yml">sample_aci_cfg.yml</a></p>
<p>Apart from the usual information in the <strong>cfg.yml</strong> (as described <a href="https://github.com/contiv/demo/tree/master/net/README.md#information-in-cfgyml">here</a>), the following additional details are required to provide access information to the APIC and the leaf(s) connected to the ACI topology.</p>
<p>All of the options listed below for ACI setup are mandatory.</p>

<h4>General APIC Reachability Information</h4>
<pre class="highlight plaintext"><code>          APIC_URL: "https://&lt;apic-server-url&gt;:443"
          APIC_USERNAME: "admin"
          APIC_PASSWORD: "password"
</code></pre>

<h4>Information Related to Leaf Nodes</h4>
<p>Provide the full paths of the leaf nodes connected to your servers. Use the informtion obtained in Step 8 of <a href="aci.md#apic-configuration-fabricaccess-policies">APIC Configuration</a> here.</p>
<pre class="highlight plaintext"><code>        APIC_LEAF_NODES:
        - topology/pod-1/node-101
        - topology/pod-1/node-102
</code></pre>

<h3>Running the Installer in ACI Mode</h3>
<p>To run the installer in ACI mode use the -a option.<br>
<code>
          ./net_demo_installer -a
</code></p>
<p>To restart the services once they are installed, use the -r option. This option ensures that the services are restarted in a clean state.<br>
<code>
          ./net_demo_installer -ar
</code></p>

<h3>Starting Containers</h3>
<p>The installer script downloads some basic containers (web/redis) that you can use to get started.</p>


			</div>
		</div>
	</div>
</div>